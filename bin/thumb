#!/bin/bash

usage()
{
    echo "Usage: $0 -w width | -h height [-s suffix] file"
    exit 1
}

if [ $# -lt 1 ] ; then
    usage
fi

convert=/usr/bin/convert
basename=/bin/basename
dim=""
suffix=""

while getopts  "w:h:s:" opt
do
    case $opt in
        w) dim=$OPTARG;;
        h) dim=x$OPTARG;;
        s) suffix=$OPTARG;;
        \?) usage;;
    esac
done

shift $(($OPTIND - 1))

if [ -z $1 ]; then
    usage
fi

input=$1
base=`$basename $input .jpg` # hand-coded extension
output=$base$suffix.jpg

$convert -resize $dim $input $output
